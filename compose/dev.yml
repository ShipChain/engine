version: '2.1'
services:


  redis_db:
    volumes:
      - /data/shipchain/engine/redis:/data


  geth-poa:
    volumes:
      - /data/shipchain/engine/chain:/geth/chain


  minio:
    volumes:
      - /data/shipchain/engine/minio:/data
      - /data/shipchain/engine/minioconfig:/root/.minio


  psql:
    volumes:
      - /data/shipchain/engine/postgresql:/var/lib/postgresql


  rpc:
    links:
      - psql
      - sftp
      - minio
      - geth-poa
      - redis_db
    depends_on:
      redis_db:
        condition: service_healthy
      minio:
        condition: service_healthy
      geth-poa:
        condition: service_healthy
      psql:
        condition: service_healthy
    environment:
      - GETH_NODE=http://geth-poa:8545
#     - ES_TEST_NODE_URL=http://elasticsearch:9200

# elasticsearch:
#   image: sebp/elk
#   ports:
#     - "5601:5601"
#     - "9200:9200"
#     - "5044:5044"
#   networks:
#     default:
#       aliases:
#         - engine-elasticsearch
#     portal:
#       aliases:
#         - engine-elasticsearch
#   environment:
#     - ES_HEAP_SIZE=2g
#     - SERVICE=engine-elasticsearch
